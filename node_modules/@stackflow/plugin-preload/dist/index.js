"use strict";var N=Object.create;var p=Object.defineProperty,A=Object.defineProperties,h=Object.getOwnPropertyDescriptor,F=Object.getOwnPropertyDescriptors,M=Object.getOwnPropertyNames,x=Object.getOwnPropertySymbols,U=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var v=(t,e,r)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,d=(t,e)=>{for(var r in e||(e={}))P.call(e,r)&&v(t,r,e[r]);if(x)for(var r of x(e))K.call(e,r)&&v(t,r,e[r]);return t},s=(t,e)=>A(t,F(e));var S=(t,e)=>{for(var r in e)p(t,r,{get:e[r],enumerable:!0})},L=(t,e,r,o)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of M(e))!P.call(t,a)&&a!==r&&p(t,a,{get:()=>e[a],enumerable:!(o=h(e,a))||o.enumerable});return t};var T=(t,e,r)=>(r=t!=null?N(U(t)):{},L(e||!t||!t.__esModule?p(r,"default",{value:t,enumerable:!0}):r,t)),B=t=>L(p({},"__esModule",{value:!0}),t);var z={};S(z,{createPreloader:()=>E,preloadPlugin:()=>I,useActivityPreloadRef:()=>O,useLoaders:()=>y,usePreloader:()=>f});module.exports=B(z);var l=require("@stackflow/plugin-history-sync"),g=require("react");var u=T(require("react")),C=(0,u.createContext)({}),k=t=>u.default.createElement(C.Provider,{value:t.loaders},t.children);function y(){return(0,u.useContext)(C)}function f(){let t=y(),e=(0,l.useRoutes)();return(0,g.useMemo)(()=>({preload(r,o,a){let n=t[r];if(!n)return null;let i=e[r],c=i?(0,l.makeTemplate)((0,l.normalizeRoute)(i)[0]):void 0,m=c==null?void 0:c.fill(o);return n({activityParams:o,activityContext:d(d({},m?{path:m}:null),a==null?void 0:a.activityContext)})}}),[t])}function E(){return{usePreloader:f}}var R=T(require("react"));function I(t){return()=>({key:"plugin-preload",wrapStack({stack:e}){return R.default.createElement(k,{loaders:t.loaders},e.render())},overrideInitialEvents({initialEvents:e,initialContext:r}){return e.length===0?[]:e.map(o=>{if(o.name!=="Pushed")return o;let{activityName:a,activityParams:n,activityContext:i}=o,c=t.loaders[a];if(!c)return o;let m=c({activityParams:n,activityContext:i,isInitialActivity:!0,initialContext:r});return s(d({},o),{activityContext:s(d({},o.activityContext),{preloadRef:m})})})},onBeforePush({actionParams:e,actions:{overrideActionParams:r}}){let{activityName:o,activityParams:a,activityContext:n}=e,i=t.loaders[o];if(!i)return;let c=i({activityParams:a,activityContext:n});r(s(d({},e),{activityContext:s(d({},n),{preloadRef:c})}))},onBeforeReplace({actionParams:e,actions:{overrideActionParams:r}}){let{activityName:o,activityParams:a,activityContext:n}=e,i=t.loaders[o];if(!i)return;let c=i({activityParams:a,activityContext:n});r(s(d({},e),{activityContext:s(d({},n),{preloadRef:c})}))}})}var w=require("@stackflow/react");function O(){let e=(0,w.useActivity)().context;return e==null?void 0:e.preloadRef}
//# sourceMappingURL=index.js.map
