{
  "version": 3,
  "sources": ["../src/activity/useActivity.ts", "../src/activity/ActivityProvider.tsx", "../src/utils/useMemoDeep.ts", "../src/activity/useActivityParams.ts", "../src/stack/useStack.ts", "../src/stack/StackProvider.tsx", "../src/stackflow.tsx", "../src/activity/makeActivityId.ts", "../src/activity/makeStepId.ts", "../src/core/CoreProvider.tsx", "../src/shims/useDeferredValue.ts", "../src/shims/useSyncExternalStore.ts", "../src/core/useCoreActions.ts", "../src/core/useCoreState.ts", "../src/MainRenderer.tsx", "../src/PluginRenderer.tsx", "../src/plugins/PluginsProvider.tsx", "../src/plugins/usePlugins.ts", "../src/useActions.ts", "../src/useStepActions.ts"],
  "sourcesContent": ["import { useContext } from \"react\";\n\nimport { ActivityContext } from \"./ActivityProvider\";\n\n/**\n * Get current activity state\n */\nexport const useActivity = () => useContext(ActivityContext);\n", "import type { Activity } from \"@stackflow/core\";\nimport React, { createContext } from \"react\";\n\nimport { useMemoDeep } from \"../utils\";\n\nexport const ActivityContext = createContext<Activity>(null as any);\n\ninterface ActivityProviderProps {\n  children: React.ReactNode;\n  value: Activity;\n}\nexport const ActivityProvider: React.FC<ActivityProviderProps> = ({\n  children,\n  value,\n}) => (\n  <ActivityContext.Provider value={useMemoDeep(value)}>\n    {children}\n  </ActivityContext.Provider>\n);\n", "import { useEffect, useRef } from \"react\";\nimport compare from \"react-fast-compare\";\n\nexport function useMemoDeep<T>(next: T) {\n  const previousRef = useRef(next);\n  const previous = previousRef.current;\n  const isEqual = compare(previous, next);\n\n  useEffect(() => {\n    if (!isEqual) {\n      previousRef.current = next;\n    }\n  });\n\n  return isEqual ? previous : next;\n}\n", "import { useContext } from \"react\";\n\nimport { ActivityContext } from \"./ActivityProvider\";\n\n/**\n * Get current activity parameters\n */\nexport function useActivityParams<\n  T extends { [key in keyof T]: string | undefined },\n>(): T {\n  return useContext(ActivityContext).params as T;\n}\n", "import { useContext } from \"react\";\n\nimport { StackContext } from \"./StackProvider\";\n\n/**\n * Get overall stack state\n */\nexport const useStack = () => useContext(StackContext);\n", "import type { AggregateOutput } from \"@stackflow/core\";\nimport React, { createContext } from \"react\";\n\nimport { useMemoDeep } from \"../utils\";\n\nexport const StackContext = createContext<AggregateOutput>(null as any);\n\ninterface StackProviderProps {\n  children: React.ReactNode;\n  value: AggregateOutput;\n}\nexport const StackProvider: React.FC<StackProviderProps> = ({\n  children,\n  value,\n}) => (\n  <StackContext.Provider value={useMemoDeep(value)}>\n    {children}\n  </StackContext.Provider>\n);\n", "import type { StackflowActions } from \"@stackflow/core\";\nimport { aggregate, createCoreStore, makeEvent } from \"@stackflow/core\";\nimport type {\n  DomainEvent,\n  PushedEvent,\n  StepPushedEvent,\n} from \"@stackflow/core/dist/event-types\";\nimport React, { useEffect, useMemo } from \"react\";\n\nimport { makeActivityId, makeStepId } from \"./activity\";\nimport type { BaseActivities } from \"./BaseActivities\";\nimport { CoreProvider } from \"./core\";\nimport MainRenderer from \"./MainRenderer\";\nimport { PluginsProvider } from \"./plugins\";\nimport type { StackflowReactPlugin } from \"./StackflowReactPlugin\";\nimport type { UseActionsOutputType } from \"./useActions\";\nimport { useActions } from \"./useActions\";\nimport type {\n  UseStepActions,\n  UseStepActionsOutputType,\n} from \"./useStepActions\";\nimport { useStepActions } from \"./useStepActions\";\n\nexport type StackComponentType = React.FC<{\n  initialContext?: any;\n}>;\n\ntype StackflowPluginsEntry<T extends BaseActivities> =\n  | StackflowReactPlugin<T>\n  | StackflowPluginsEntry<T>[];\n\nfunction parseActionOptions(options?: { animate?: boolean }) {\n  if (!options) {\n    return { skipActiveState: false };\n  }\n\n  const isNullableAnimateOption =\n    options.animate === undefined || options.animate == null;\n  if (isNullableAnimateOption) {\n    return { skipActiveState: false };\n  }\n\n  return { skipActiveState: !options.animate };\n}\n\nexport type StackflowOptions<T extends BaseActivities> = {\n  /**\n   * Register activities used in your app\n   */\n  activities: T;\n\n  /**\n   * Transition duration for stack animation (millisecond)\n   */\n  transitionDuration: number;\n\n  /**\n   * Set the first activity to load at the bottom\n   * (It can be overwritten by plugin)\n   */\n  initialActivity?: () => Extract<keyof T, string>;\n\n  /**\n   * Inject stackflow plugins\n   */\n  plugins?: Array<StackflowPluginsEntry<T>>;\n};\n\nexport type StackflowOutput<T extends BaseActivities> = {\n  /**\n   * Created `<Stack />` component\n   */\n  Stack: StackComponentType;\n\n  /**\n   * Created `useFlow()` hooks\n   */\n  useFlow: () => UseActionsOutputType<T>;\n\n  /**\n   * Created `useStepFlow()` hooks\n   */\n  useStepFlow: UseStepActions<T>;\n\n  /**\n   * Created action triggers\n   */\n  actions: Pick<StackflowActions, \"dispatchEvent\" | \"getStack\"> &\n    Pick<UseActionsOutputType<T>, \"push\" | \"pop\" | \"replace\"> &\n    Pick<UseStepActionsOutputType<{}>, \"stepPush\" | \"stepReplace\" | \"stepPop\">;\n\n  /**\n   * Return activities\n   */\n  activities: T;\n};\n\n/**\n * Make `<Stack />` component and `useFlow()` hooks that strictly typed with `activities`\n */\nexport function stackflow<T extends BaseActivities>(\n  options: StackflowOptions<T>,\n): StackflowOutput<T> {\n  const plugins = (options.plugins ?? [])\n    .flat(Infinity as 0)\n    .map((p) => p as StackflowReactPlugin<T>);\n  const pluginInstances = plugins.map((plugin) => plugin());\n\n  const activities = Object.entries(options.activities).reduce(\n    (acc, [key, Activity]) => {\n      if (\"component\" in Activity) {\n        return {\n          ...acc,\n          [key]: {\n            paramsSchema: Activity.paramsSchema,\n            component: Activity.component,\n          },\n        };\n      }\n\n      return {\n        ...acc,\n        [key]: React.memo(Activity),\n      };\n    },\n    {} as T,\n  );\n\n  const initialEventDate = () =>\n    new Date().getTime() - options.transitionDuration;\n\n  const initialEvents = (): DomainEvent[] => {\n    const initializedEvent = makeEvent(\"Initialized\", {\n      transitionDuration: options.transitionDuration,\n      eventDate: initialEventDate(),\n    });\n\n    const activityRegisteredEvents = Object.entries(activities).map(\n      ([activityName, Activity]) =>\n        makeEvent(\"ActivityRegistered\", {\n          activityName,\n          eventDate: initialEventDate(),\n          ...(\"component\" in Activity\n            ? {\n                activityParamsSchema: Activity.paramsSchema,\n              }\n            : null),\n        }),\n    );\n\n    return [initializedEvent, ...activityRegisteredEvents];\n  };\n\n  const initialStack = aggregate(initialEvents(), new Date().getTime());\n\n  const coreStoreRef: {\n    value: ReturnType<typeof createCoreStore> | null;\n  } = {\n    value: null,\n  };\n\n  if (typeof window !== \"undefined\") {\n    const html = window.document.documentElement;\n\n    html.style.setProperty(\n      \"--stackflow-transition-duration\",\n      `${options.transitionDuration}ms`,\n    );\n  }\n\n  const actions: StackflowOutput<T>[\"actions\"] = {\n    dispatchEvent(name, parameters) {\n      return coreStoreRef.value?.actions.dispatchEvent(name, parameters);\n    },\n    getStack() {\n      return coreStoreRef.value?.actions.getStack() ?? initialStack;\n    },\n    push(activityName, activityParams, options) {\n      const activityId = makeActivityId();\n\n      coreStoreRef.value?.actions.push({\n        activityId,\n        activityName,\n        activityParams,\n        skipEnterActiveState: parseActionOptions(options).skipActiveState,\n      });\n\n      return {\n        activityId,\n      };\n    },\n    replace(activityName, activityParams, options) {\n      const activityId = options?.activityId ?? makeActivityId();\n\n      coreStoreRef.value?.actions.replace({\n        activityId: options?.activityId ?? makeActivityId(),\n        activityName,\n        activityParams,\n        skipEnterActiveState: parseActionOptions(options).skipActiveState,\n      });\n\n      return {\n        activityId,\n      };\n    },\n    pop(options) {\n      return coreStoreRef.value?.actions.pop({\n        skipExitActiveState: parseActionOptions(options).skipActiveState,\n      });\n    },\n    stepPush(params) {\n      const stepId = makeStepId();\n\n      return coreStoreRef.value?.actions.stepPush({\n        stepId,\n        stepParams: params,\n      });\n    },\n    stepReplace(params) {\n      const stepId = makeStepId();\n\n      return coreStoreRef.value?.actions.stepReplace({\n        stepId,\n        stepParams: params,\n      });\n    },\n    stepPop() {\n      return coreStoreRef.value?.actions.stepPop({});\n    },\n  };\n\n  const Stack: StackComponentType = (props) => {\n    const coreStore = useMemo(() => {\n      const initialPushedEventsByOption = options.initialActivity\n        ? [\n            makeEvent(\"Pushed\", {\n              activityId: makeActivityId(),\n              activityName: options.initialActivity(),\n              activityParams: {},\n              eventDate: initialEventDate(),\n              skipEnterActiveState: false,\n            }),\n          ]\n        : [];\n\n      const initialPushedEvents = pluginInstances.reduce<\n        (PushedEvent | StepPushedEvent)[]\n      >(\n        (initialEvents, pluginInstance) =>\n          pluginInstance.overrideInitialEvents?.({\n            initialEvents,\n            initialContext: props.initialContext ?? {},\n          }) ?? initialEvents,\n        initialPushedEventsByOption,\n      );\n\n      const isInitialActivityIgnored =\n        initialPushedEvents.length > 0 &&\n        initialPushedEventsByOption.length > 0 &&\n        initialPushedEvents !== initialPushedEventsByOption;\n\n      if (isInitialActivityIgnored) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          `Stackflow - ` +\n            ` Some plugin overrides an \"initialActivity\" option.` +\n            ` The \"initialActivity\" option you set to \"${initialPushedEventsByOption[0].activityName}\" in the \"stackflow\" is ignored.`,\n        );\n      }\n\n      if (initialPushedEvents.length === 0) {\n        // eslint-disable-next-line no-console\n        console.warn(\n          `Stackflow - ` +\n            ` There is no initial activity.` +\n            \" If you want to set the initial activity,\" +\n            \" add the `initialActivity` option of the `stackflow()` function or\" +\n            \" add a plugin that sets the initial activity. (e.g. `@stackflow/plugin-history-sync`)\",\n        );\n      }\n\n      const store = createCoreStore({\n        initialEvents: [...initialEvents(), ...initialPushedEvents],\n        plugins,\n      });\n\n      coreStoreRef.value = store;\n\n      return store;\n    }, []);\n\n    useEffect(() => {\n      coreStore.init();\n    }, [coreStore]);\n\n    return (\n      <PluginsProvider value={pluginInstances}>\n        <CoreProvider coreStore={coreStore}>\n          <MainRenderer activities={activities} />\n        </CoreProvider>\n      </PluginsProvider>\n    );\n  };\n\n  return {\n    Stack,\n    useFlow: useActions,\n    useStepFlow: useStepActions,\n    actions,\n    activities,\n  };\n}\n", "import { id } from \"@stackflow/core\";\n\nexport function makeActivityId() {\n  return id();\n}\n", "import { id } from \"@stackflow/core\";\n\nexport function makeStepId() {\n  return id();\n}\n", "import type { AggregateOutput, CreateCoreStoreOutput } from \"@stackflow/core\";\nimport React, { createContext } from \"react\";\n\nimport { useDeferredValue, useSyncExternalStore } from \"../shims\";\n\nexport const CoreActionsContext = createContext<\n  CreateCoreStoreOutput[\"actions\"]\n>(null as any);\nexport const CoreStateContext = createContext<AggregateOutput>(null as any);\n\nexport interface CoreProviderProps {\n  coreStore: CreateCoreStoreOutput;\n  children: React.ReactNode;\n}\nexport const CoreProvider: React.FC<CoreProviderProps> = ({\n  coreStore,\n  children,\n}) => {\n  const stack = useSyncExternalStore(\n    coreStore.subscribe,\n    coreStore.actions.getStack,\n    coreStore.actions.getStack,\n  );\n\n  const deferredStack = useDeferredValue(stack);\n\n  return (\n    <CoreStateContext.Provider value={deferredStack}>\n      <CoreActionsContext.Provider value={coreStore.actions}>\n        {children}\n      </CoreActionsContext.Provider>\n    </CoreStateContext.Provider>\n  );\n};\n", "import React from \"react\";\n\nexport const useDeferredValue: typeof React.useDeferredValue =\n  React.useDeferredValue ?? ((value) => value);\n", "import React, { useEffect, useState } from \"react\";\n\nexport const useSyncExternalStore: typeof React.useSyncExternalStore =\n  React.useSyncExternalStore ??\n  ((subscribe, getSnapshot) => {\n    const [state, setState] = useState(() => getSnapshot());\n\n    useEffect(() => {\n      const dispose = subscribe(() => {\n        setState(() => getSnapshot());\n      });\n\n      return dispose;\n    });\n\n    return state;\n  });\n", "import React from \"react\";\n\nimport { CoreActionsContext } from \"./CoreProvider\";\n\nexport const useCoreActions = () => React.useContext(CoreActionsContext);\n", "import React from \"react\";\n\nimport { CoreStateContext } from \"./CoreProvider\";\n\nexport const useCoreState = () => React.useContext(CoreStateContext);\n", "import React, { useEffect } from \"react\";\n\nimport type { BaseActivities } from \"./BaseActivities\";\nimport { useCoreState } from \"./core\";\nimport PluginRenderer from \"./PluginRenderer\";\nimport { usePlugins } from \"./plugins\";\nimport type { WithRequired } from \"./utils\";\n\ninterface MainRendererProps {\n  activities: BaseActivities;\n}\nconst MainRenderer: React.FC<MainRendererProps> = ({ activities }) => {\n  const coreState = useCoreState();\n  const plugins = usePlugins();\n\n  const renderingPlugins = plugins.filter(\n    (plugin): plugin is WithRequired<typeof plugin, \"render\"> =>\n      !!plugin.render,\n  );\n\n  useEffect(() => {\n    if (renderingPlugins.length === 0) {\n      // eslint-disable-next-line no-console\n      console.warn(\n        `Stackflow -` +\n          ` There is no rendering plugin, so \"<Stack />\" doesn't render anything.` +\n          ` If you want to render some UI, use \"@stackflow/plugin-renderer-basic\"` +\n          ` or add another rendering plugin.`,\n      );\n    }\n  }, [renderingPlugins]);\n\n  let output = (\n    <>\n      {renderingPlugins.map((plugin) => (\n        <PluginRenderer\n          key={plugin.key}\n          activities={activities}\n          plugin={plugin}\n        />\n      ))}\n    </>\n  );\n\n  plugins.forEach((plugin) => {\n    output =\n      plugin.wrapStack?.({\n        stack: {\n          ...coreState,\n          render() {\n            return output;\n          },\n        },\n      }) ?? output;\n  });\n\n  return output;\n};\n\nexport default MainRenderer;\n", "import React from \"react\";\n\nimport { ActivityProvider } from \"./activity\";\nimport type { BaseActivities } from \"./BaseActivities\";\nimport { useCoreState } from \"./core\";\nimport { usePlugins } from \"./plugins\";\nimport { StackProvider } from \"./stack\";\nimport type { StackflowReactPlugin } from \"./StackflowReactPlugin\";\nimport type { WithRequired } from \"./utils\";\n\ninterface PluginRendererProps {\n  activities: BaseActivities;\n  plugin: WithRequired<ReturnType<StackflowReactPlugin>, \"render\">;\n}\nconst PluginRenderer: React.FC<PluginRendererProps> = ({\n  activities,\n  plugin,\n}) => {\n  const coreState = useCoreState();\n  const plugins = usePlugins();\n\n  return plugin.render({\n    stack: {\n      ...coreState,\n      render(overrideStack) {\n        const stack = {\n          ...coreState,\n          ...overrideStack,\n        };\n\n        return {\n          activities: stack.activities.map((activity) => ({\n            ...activity,\n            key: activity.id,\n            render(overrideActivity) {\n              const Activity = activities[activity.name];\n              let output: React.ReactNode;\n\n              if (\"component\" in Activity) {\n                const { component: ActivityComponent } = Activity;\n                output = <ActivityComponent params={activity.params} />;\n              } else {\n                output = <Activity params={activity.params} />;\n              }\n\n              plugins.forEach((p) => {\n                output =\n                  p.wrapActivity?.({\n                    activity: {\n                      ...activity,\n                      render: () => output,\n                    },\n                  }) ?? output;\n              });\n\n              return (\n                <StackProvider value={stack}>\n                  <ActivityProvider\n                    key={activity.id}\n                    value={{\n                      ...activity,\n                      ...overrideActivity,\n                    }}\n                  >\n                    {output}\n                  </ActivityProvider>\n                </StackProvider>\n              );\n            },\n          })),\n        };\n      },\n    },\n  });\n};\n\nexport default PluginRenderer;\n", "import React, { createContext } from \"react\";\n\nimport type { StackflowReactPlugin } from \"../StackflowReactPlugin\";\n\nexport type PluginsContextValue = Array<ReturnType<StackflowReactPlugin>>;\nexport const PluginsContext = createContext<PluginsContextValue>(null as any);\n\ninterface PluginsProviderProps {\n  children: React.ReactNode;\n  value: PluginsContextValue;\n}\nexport const PluginsProvider: React.FC<PluginsProviderProps> = ({\n  children,\n  value,\n}) => (\n  <PluginsContext.Provider value={value}>{children}</PluginsContext.Provider>\n);\n", "import { useContext } from \"react\";\n\nimport { PluginsContext } from \"./PluginsProvider\";\n\nexport function usePlugins() {\n  return useContext(PluginsContext);\n}\n", "import React, { useMemo } from \"react\";\n\nimport type { ActivityComponentType } from \"./activity\";\nimport { makeActivityId } from \"./activity\";\nimport type { BaseActivities } from \"./BaseActivities\";\nimport { useCoreActions } from \"./core\";\n\nfunction parseActionOptions(options?: { animate?: boolean }) {\n  if (!options) {\n    return { skipActiveState: false };\n  }\n\n  const isNullableAnimateOption =\n    options.animate === undefined || options.animate == null;\n  if (isNullableAnimateOption) {\n    return { skipActiveState: false };\n  }\n\n  return { skipActiveState: !options.animate };\n}\n\nexport type UseActionsOutputType<T extends BaseActivities> = {\n  /**\n   * Is transition pending\n   */\n  pending: boolean;\n\n  /**\n   * Push new activity\n   */\n  push: <K extends Extract<keyof T, string>>(\n    activityName: K,\n    params: T[K] extends\n      | ActivityComponentType<infer U>\n      | { component: ActivityComponentType<infer U> }\n      ? U\n      : {},\n    options?: {\n      animate?: boolean;\n    },\n  ) => {\n    activityId: string;\n  };\n\n  /**\n   * Push new activity in the top and remove current top activity when new activity is activated\n   */\n  replace: <K extends Extract<keyof T, string>>(\n    activityName: K,\n    params: T[K] extends\n      | ActivityComponentType<infer U>\n      | { component: ActivityComponentType<infer U> }\n      ? U\n      : {},\n    options?: {\n      animate?: boolean;\n      activityId?: string;\n    },\n  ) => {\n    activityId: string;\n  };\n\n  /**\n   * Remove top activity\n   */\n  pop: (options?: { animate?: boolean }) => void;\n};\n\nconst useTransition: () => [boolean, React.TransitionStartFunction] =\n  React.useTransition ?? (() => [false, (cb: () => void) => cb()]);\n\nexport function useActions<\n  T extends BaseActivities,\n>(): UseActionsOutputType<T> {\n  const coreActions = useCoreActions();\n  const [pending, startTransition] = useTransition();\n\n  return useMemo(\n    () => ({\n      pending,\n      push(activityName, activityParams, options) {\n        const activityId = makeActivityId();\n\n        coreActions.push({\n          activityId,\n          activityName,\n          activityParams,\n          skipEnterActiveState: parseActionOptions(options).skipActiveState,\n        });\n\n        return {\n          activityId,\n        };\n      },\n      replace(activityName, activityParams, options) {\n        const activityId = makeActivityId();\n\n        coreActions.replace({\n          activityId: options?.activityId ?? makeActivityId(),\n          activityName,\n          activityParams,\n          skipEnterActiveState: parseActionOptions(options).skipActiveState,\n        });\n\n        return {\n          activityId,\n        };\n      },\n      pop(options) {\n        coreActions.pop({\n          skipExitActiveState: parseActionOptions(options).skipActiveState,\n        });\n      },\n    }),\n    [\n      coreActions.push,\n      coreActions.replace,\n      coreActions.pop,\n      pending,\n      startTransition,\n    ],\n  );\n}\n", "import React, { useMemo } from \"react\";\n\nimport type { ActivityComponentType } from \"./activity\";\nimport { makeStepId } from \"./activity\";\nimport type { BaseActivities } from \"./BaseActivities\";\nimport { useCoreActions } from \"./core\";\n\nexport type UseStepActionsOutputType<P> = {\n  pending: boolean;\n  stepPush: (params: P, options?: {}) => void;\n  stepReplace: (params: P, options?: {}) => void;\n  stepPop: (options?: {}) => void;\n};\n\nexport type UseStepActions<T extends BaseActivities = {}> = <\n  K extends Extract<keyof T, string>,\n>(\n  activityName: K,\n) => UseStepActionsOutputType<\n  T[K] extends\n    | ActivityComponentType<infer U>\n    | { component: ActivityComponentType<infer U> }\n    ? U\n    : {}\n>;\n\nconst useTransition: () => [boolean, React.TransitionStartFunction] =\n  React.useTransition ?? (() => [false, (cb: () => void) => cb()]);\n\nexport const useStepActions: UseStepActions = () => {\n  const coreActions = useCoreActions();\n  const [pending, startTransition] = useTransition();\n\n  return useMemo(\n    () => ({\n      pending,\n      stepPush(params) {\n        const stepId = makeStepId();\n\n        coreActions.stepPush({\n          stepId,\n          stepParams: params,\n        });\n      },\n      stepReplace(params) {\n        const stepId = makeStepId();\n\n        coreActions.stepReplace({\n          stepId,\n          stepParams: params,\n        });\n      },\n      stepPop() {\n        coreActions.stepPop({});\n      },\n    }),\n    [\n      coreActions.stepPush,\n      coreActions.stepReplace,\n      coreActions.stepPop,\n      pending,\n      startTransition,\n    ],\n  );\n};\n"],
  "mappings": "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",
  "names": ["useContext", "React", "createContext", "useEffect", "useRef", "compare", "useMemoDeep", "next", "previousRef", "previous", "isEqual", "ActivityContext", "createContext", "ActivityProvider", "children", "value", "React", "useMemoDeep", "useActivity", "useContext", "ActivityContext", "useContext", "useActivityParams", "useContext", "ActivityContext", "useContext", "React", "createContext", "StackContext", "createContext", "StackProvider", "children", "value", "React", "useMemoDeep", "useStack", "useContext", "StackContext", "aggregate", "createCoreStore", "makeEvent", "React", "useEffect", "useMemo", "id", "makeActivityId", "id", "makeStepId", "React", "createContext", "React", "_a", "useDeferredValue", "value", "React", "useEffect", "useState", "_a", "useSyncExternalStore", "subscribe", "getSnapshot", "state", "setState", "CoreActionsContext", "createContext", "CoreStateContext", "CoreProvider", "coreStore", "children", "stack", "useSyncExternalStore", "deferredStack", "useDeferredValue", "React", "React", "useCoreActions", "React", "CoreActionsContext", "React", "useCoreState", "React", "CoreStateContext", "React", "useEffect", "React", "React", "createContext", "PluginsContext", "PluginsProvider", "children", "value", "useContext", "usePlugins", "useContext", "PluginsContext", "PluginRenderer", "activities", "plugin", "coreState", "useCoreState", "plugins", "usePlugins", "__spreadProps", "__spreadValues", "overrideStack", "stack", "activity", "overrideActivity", "Activity", "output", "ActivityComponent", "React", "p", "_a", "_b", "StackProvider", "ActivityProvider", "PluginRenderer_default", "MainRenderer", "activities", "coreState", "useCoreState", "plugins", "usePlugins", "renderingPlugins", "plugin", "useEffect", "output", "React", "PluginRenderer_default", "_a", "_b", "__spreadProps", "__spreadValues", "MainRenderer_default", "React", "useMemo", "parseActionOptions", "options", "_a", "useTransition", "React", "cb", "useActions", "coreActions", "useCoreActions", "pending", "startTransition", "useMemo", "activityName", "activityParams", "activityId", "makeActivityId", "React", "useMemo", "_a", "useTransition", "React", "cb", "useStepActions", "coreActions", "useCoreActions", "pending", "startTransition", "useMemo", "params", "stepId", "makeStepId", "parseActionOptions", "options", "stackflow", "_a", "plugins", "p", "pluginInstances", "plugin", "activities", "acc", "key", "Activity", "__spreadProps", "__spreadValues", "React", "initialEventDate", "initialEvents", "initializedEvent", "makeEvent", "activityRegisteredEvents", "activityName", "initialStack", "aggregate", "coreStoreRef", "props", "coreStore", "useMemo", "initialPushedEventsByOption", "makeActivityId", "initialPushedEvents", "pluginInstance", "_b", "_c", "store", "createCoreStore", "useEffect", "PluginsProvider", "CoreProvider", "MainRenderer_default", "useActions", "useStepActions", "name", "parameters", "activityParams", "activityId", "params", "stepId", "makeStepId"]
}
