"use strict";var N=Object.create;var m=Object.defineProperty;var b=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames,T=Object.getOwnPropertySymbols,M=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var h=(e,t,n)=>t in e?m(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,u=(e,t)=>{for(var n in t||(t={}))k.call(t,n)&&h(e,n,t[n]);if(T)for(var n of T(t))w.call(t,n)&&h(e,n,t[n]);return e};var H=(e,t)=>{for(var n in t)m(e,n,{get:t[n],enumerable:!0})},p=(e,t,n,a)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of C(t))!k.call(e,o)&&o!==n&&m(e,o,{get:()=>t[o],enumerable:!(a=b(t,o))||a.enumerable});return e};var O=(e,t,n)=>(n=e!=null?N(M(e)):{},p(t||!e||!e.__esModule?m(n,"default",{value:e,enumerable:!0}):n,e)),D=e=>p(m({},"__esModule",{value:!0}),e);var U={};H(U,{Link:()=>s,createLinkComponent:()=>F});module.exports=D(U);var c=require("@stackflow/plugin-history-sync"),R=require("@stackflow/plugin-preload"),x=require("@stackflow/react"),i=O(require("react"));var L=(...e)=>{let t=e.filter(n=>!!n);return t.length?t.length===0?t[0]:n=>{t.forEach(a=>{typeof a=="function"?a(n):a&&(a.current=n)})}:null};function P(e,t){let n=u({},e);return t.forEach(a=>{delete n[a]}),n}var s=i.default.forwardRef((e,t)=>{let n=(0,c.useRoutes)(),{preload:a}=(0,R.usePreloader)(),{push:o,replace:A}=(0,x.useActions)(),f=(0,i.useRef)(null),[E,y]=(0,i.useReducer)(()=>!0,!1),d=(0,i.useMemo)(()=>{let r=n[e.activityName];return r?(0,c.makeTemplate)((0,c.normalizeRoute)(r)[0]).fill(e.activityParams):void 0},[n,e.activityName,e.activityParams]);(0,i.useEffect)(()=>{if(E||!f.current)return()=>{};let r=f.current,l=new IntersectionObserver(([{isIntersecting:v}])=>{v&&(a(e.activityName,e.activityParams,{activityContext:{path:d}}),y())});return l.observe(r),()=>{l.unobserve(r),l.disconnect()}},[f,y]);let g=P(e,["activityName","activityParams","animate","onClick"]),K=r=>{e.onClick&&e.onClick(r),(r.button===0&&!(r.currentTarget.target&&r.currentTarget.target!=="_self")||!r.defaultPrevented&&!r.metaKey&&!r.altKey&&!r.ctrlKey&&!r.shiftKey&&!(r.nativeEvent&&r.nativeEvent.which===2))&&(r.preventDefault(),e.replace?A(e.activityName,e.activityParams,typeof e.animate=="undefined"||e.animate===null?{}:{animate:e.animate}):o(e.activityName,e.activityParams,typeof e.animate=="undefined"||e.animate===null?{}:{animate:e.animate}))};return i.default.createElement("a",u({ref:L(t,f),href:d,onClick:K},g),e.children)});function F(){return{Link:s}}
//# sourceMappingURL=index.js.map
